<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="icon" href="/favicon.ico" />
    <title><%= title %></title>
    <meta
      name="description"
      content="<%= (!!locals.description) ? description : site.description %>"
    />
    <meta name="author" content="<%= site.author %>" />
    <meta property="og:title" content="<%= title %>" />
    <meta
      property="og:description"
      content="<%= (!!locals.description) ? description : site.description %>"
    />
    <meta property="og:locale" content="<%= site.locale %>" />
    <meta property="og:site_name" content="<%= site.site_name %>" />
    <script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.6/lib/darkmode-js.min.js"></script>
    <script>
      function addDarkmodeWidget() {
      const option = {
        bottom: '32px',
        left: 'unset',
        right: '32px',
        time: '0.3s',
        mixColor: '#fff',
        backgroundColor: '#fff',
        buttonColorDark: '#100f2c',
        buttonColorLight: '#fff',
        label: 'ðŸŒ“',
        autoMatchOsTheme: true
      }
        new Darkmode(option).showWidget();
      }
      window.addEventListener('load', addDarkmodeWidget);
    </script>
    <% if (locals.tags == "posts") { %>
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="<%= date.toISOString() %>" />
    <script type="application/ld+json">
      {
        "description": "<%= (!!locals.description) ? description : site.description %>",
        "author": { "@type": "Person", "name": "<%= site.author %>" },
        "@type": "BlogPosting",
        "url": "<%= `${site.url}${page.url}` %>",
        "publisher": {
          "@type": "Organization",
          "logo": {
            "@type": "ImageObject",
            "url": "<%= `${site.url}/assets/images/logo.png` %>"
          },
          "name": "<%= site.author %>"
        },
        "headline": "<%= title %>",
        "datePublished": "<%= date.toISOString() %>",
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "<%= `${site.url}${page.url}` %>"
        },
        "@context": "http://schema.org"
      }
    </script>
    <% } %> <%- include('webpack.ejs') %>
  </head>
  <body style="word-break:break-all">
    <script>
      var supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;
      var darkmode = localStorage.getItem('darkmode')
      if (!darkmode && supportDarkMode) {
        document.body.style.background = '#000'
      }
      if (darkmode) {
        document.body.style.background = '#000'
      }
    </script>
    <%- content %>
  </body>
  <script>
  window.addEventListener('load', function() {
    function button(label, ariaLabel, icon, className) {
      const btn = document.createElement('button');
      btn.classList.add('btnIcon', className);
      btn.setAttribute('type', 'button');
      btn.setAttribute('aria-label', ariaLabel);
      btn.innerHTML =
        '<div class="btnIcon__body">' +
        icon +
        '<strong class="btnIcon__label">' +
        label +
        '</strong>' +
        '</div>';
      return btn;
    }

    function addButtons(codeBlockSelector, btn) {
      document.querySelectorAll(codeBlockSelector).forEach(function(code) {
        code.parentNode.appendChild(btn.cloneNode(true));
      });
    }

    const copyIcon =
      '<svg width="12" height="12" viewBox="340 364 14 15" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M342 375.974h4v.998h-4v-.998zm5-5.987h-5v.998h5v-.998zm2 2.994v-1.995l-3 2.993 3 2.994v-1.996h5v-1.995h-5zm-4.5-.997H342v.998h2.5v-.997zm-2.5 2.993h2.5v-.998H342v.998zm9 .998h1v1.996c-.016.28-.11.514-.297.702-.187.187-.422.28-.703.296h-10c-.547 0-1-.452-1-.998v-10.976c0-.546.453-.998 1-.998h3c0-1.107.89-1.996 2-1.996 1.11 0 2 .89 2 1.996h3c.547 0 1 .452 1 .998v4.99h-1v-2.995h-10v8.98h10v-1.996zm-9-7.983h8c0-.544-.453-.996-1-.996h-1c-.547 0-1-.453-1-.998 0-.546-.453-.998-1-.998-.547 0-1 .452-1 .998 0 .545-.453.998-1 .998h-1c-.547 0-1 .452-1 .997z" fill-rule="evenodd"/></svg>';

    addButtons(
      '.hljs',
      button('Copy', 'Copy code to clipboard', copyIcon, 'btnClipboard'),
    );

    const clipboard = new ClipboardJS('.btnClipboard', {
      target: function(trigger) {
        return trigger.parentNode.querySelector('code');
      },
    });

    clipboard.on('success', function(event) {
      event.clearSelection();
      const textEl = event.trigger.querySelector('.btnIcon__label');
      textEl.textContent = 'Copied';
      setTimeout(function() {
        textEl.textContent = 'Copy';
      }, 2000);
    });
  });
  </script>
</html>
