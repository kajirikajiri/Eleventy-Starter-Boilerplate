---
title: obsidianと連携した.md
description: description
date: 2020-08-23 17:23:58
---
<!-- history area start -->
<details><summary>commit history</summary><div><ol>

</ol></div></details>
<!-- history area end -->
<!-- toc area start -->
<details><summary>headline</summary><div>
<!-- START doctoc -->
<!-- END doctoc -->

</div></details>

<!-- toc area end -->
# やったこと
このブログの記事を格納しているディレクトリをobsidianと連携した

これで知識を格納しつつ記事を作成できる。

残念な状態でアップロードされているかもしれないという懸念があるが、のこらないよりはいいだろう

この連携に際して、色々作成した。

# 開発したもの

yarn commitというコマンドを作成した

```json
    "commit": "git add ./src/posts && ./node_modules/.bin/ts-node ./markdown-manager/runner.ts && ./doctoc.sh && git add . && git commit -m 'yarn commit'"
```

上記コマンドを実行するとまず、git addを実行する。自分が記事を格納しているdirectoryにあるファイルをaddする

次に、runner.tsを実行する。runner.tsではいろいろやった。

- headerを書き込む
- 記事に見出しをつける
- 記事にcommit履歴を貼る
- ファイル名を変更する

## headerを書き込む

まず、markdownのheaderを書きこんだ。

```
---
title: cargo-makeやってみた
description: input description
date: 2020-08-16 14:45:50
---
```

headerのタイトルはファイル名を取得して書き込む。 更新の際には変更しない

descriptionはあとから書き込む想定で、適当に入れた。更新の際には変更しない

dateはyarn commitが実行された時間をそのまま入れた。更新の際には最新の値が入る

更新をどうやって判断するかに迷ったが、上記手順のファイル名を変更するでファイル名の先頭にYYYYMMDDhhmmssを付加するのだが、それがある場合は更新であるという判断にした。

dateは最初、最後にcommitした時間を取得しようとしたが、そうするとうまくできない。まず、ファイルを作成したとする。そのファイルをaddして、yarn commitを実行すると、commit されていないので時間を取得できない。次に、commit後にyarn commitをしようかと判斷したが、新しくファイルを作成してcommitしてコミット時間を取得、だが、そのコミット時間はすでに過去になっている。かつ、コミット時間をファイルに書き込むのでそこで新しくコミットが必要になる、そのループに陥ってどうにも出来なかった。

これでheaderの書き込みに成功した

## 記事に見出しをつける

記事の見出しは

[[obsidian]][[連携]]
